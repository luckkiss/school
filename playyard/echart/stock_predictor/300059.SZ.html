<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    <script src="echarts/echarts.min.js"></script>
</head>
<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 100vw;height:100vh;"></div>
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        var upColor = '#ec0000';
		var upBorderColor = '#8A0000';
		var downColor = '#00da3c';
		var downBorderColor = '#008F28';
		
		var chartTitle = '300059.SZ';


		// 数据意义：开盘(open)，收盘(close)，最低(lowest)，最高(highest)
		var data0 = splitData([["2019/1/2", 10.07, 9.86, 9.82, 10.07], ["2019/1/3", 9.86, 9.98, 9.86, 10.23], ["2019/1/4", 9.84, 10.65, 9.83, 10.81], ["2019/1/7", 10.57, 10.67, 10.51, 10.76], ["2019/1/8", 10.6, 10.61, 10.53, 10.74], ["2019/1/9", 10.65, 10.6, 10.6, 10.93], ["2019/1/10", 10.55, 10.41, 10.4, 10.62], ["2019/1/11", 10.45, 10.54, 10.41, 10.6], ["2019/1/14", 10.61, 10.43, 10.39, 10.64], ["2019/1/15", 10.41, 10.82, 10.41, 10.84], ["2019/1/16", 10.82, 10.67, 10.64, 10.87], ["2019/1/17", 10.7, 10.51, 10.5, 10.71], ["2019/1/18", 10.56, 10.72, 10.52, 10.74], ["2019/1/21", 10.75, 10.72, 10.68, 10.93], ["2019/1/22", 10.69, 10.61, 10.57, 10.75], ["2019/1/23", 10.61, 10.63, 10.56, 10.68], ["2019/1/24", 10.64, 10.76, 10.6, 10.92], ["2019/1/25", 10.76, 10.76, 10.7, 10.95], ["2019/1/28", 10.91, 10.73, 10.68, 10.98], ["2019/1/29", 10.66, 10.54, 10.42, 10.67], ["2019/1/30", 10.48, 10.37, 10.37, 10.61], ["2019/1/31", 10.47, 10.71, 10.44, 10.84], ["2019/2/1", 10.82, 11.06, 10.78, 11.09], ["2019/2/11", 11.06, 11.25, 10.99, 11.28], ["2019/2/12", 11.24, 11.17, 11.1, 11.3], ["2019/2/13", 11.2, 11.64, 11.15, 11.8], ["2019/2/14", 11.6, 11.55, 11.45, 11.64], ["2019/2/15", 11.53, 11.29, 11.26, 11.55], ["2019/2/18", 11.39, 12.05, 11.38, 12.05], ["2019/2/19", 12.05, 11.99, 11.85, 12.54], ["2019/2/20", 11.95, 12.04, 11.8, 12.15], ["2019/2/21", 11.97, 12.76, 11.9, 13.24], ["2019/2/22", 12.89, 14.04, 12.64, 14.04], ["2019/2/25", 15.44, 15.44, 14.98, 15.44], ["2019/2/26", 16.65, 16.23, 16.16, 16.99], ["2019/2/27", 16.37, 15.78, 15.33, 16.77], ["2019/2/28", 15.48, 16.32, 15.03, 16.55], ["2019/3/1", 16.51, 17.4, 16.01, 17.8], ["2019/3/4", 17.77, 17.44, 16.98, 18.88], ["2019/3/5", 17.01, 17.71, 16.91, 17.77], ["2019/3/6", 17.48, 18.5, 17.38, 19.05], ["2019/3/7", 18.18, 17.76, 17.48, 18.71], ["2019/3/8", 16.63, 16.07, 16.02, 17.26], ["2019/3/11", 16.17, 16.58, 15.91, 16.79], ["2019/3/12", 16.55, 16.92, 16.51, 17.57], ["2019/3/13", 16.82, 16.17, 16.09, 16.83], ["2019/3/14", 16.02, 16.16, 15.74, 16.52], ["2019/3/15", 16.32, 16.02, 15.92, 16.43], ["2019/3/18", 15.97, 16.62, 15.53, 16.69], ["2019/3/19", 16.47, 16.32, 16.19, 16.64], ["2019/3/20", 16.33, 16.54, 16.22, 16.82], ["2019/3/21", 16.63, 16.85, 16.45, 17.42], ["2019/3/22", 16.77, 16.52, 16.16, 16.92], ["2019/3/25", 16.07, 15.64, 15.61, 16.23], ["2019/3/26", 15.78, 15.28, 15.1, 15.9], ["2019/3/27", 15.41, 15.33, 15.05, 15.53], ["2019/3/28", 15.17, 14.99, 14.99, 15.45], ["2019/3/29", 15.13, 16.13, 15.06, 16.15], ["2019/4/1", 16.2, 16.86, 15.98, 17.38], ["2019/4/2", 16.87, 17.02, 16.74, 17.91], ["2019/4/3", 16.67, 17.38, 16.63, 17.56], ["2019/4/4", 17.51, 17.11, 17.02, 17.65], ["2019/4/8", 17.32, 16.72, 16.32, 17.33], ["2019/4/9", 16.64, 16.57, 16.33, 16.88], ["2019/4/10", 16.42, 15.99, 15.75, 16.45], ["2019/4/11", 15.93, 15.92, 15.64, 16.2], ["2019/4/12", 15.95, 15.95, 15.83, 16.13], ["2019/4/15", 16.32, 15.43, 15.4, 16.41], ["2019/4/16", 15.32, 15.94, 15.21, 15.96], ["2019/4/17", 15.78, 15.75, 15.68, 15.94], ["2019/4/18", 15.72, 15.71, 15.65, 15.93], ["2019/4/19", 15.82, 16.02, 15.74, 16.09], ["2019/4/22", 16.19, 15.59, 15.51, 16.29], ["2019/4/23", 15.55, 15.68, 15.34, 16.04], ["2019/4/24", 15.68, 15.87, 15.51, 15.93], ["2019/4/25", 15.8, 15.2, 15.17, 15.93], ["2019/4/26", 15.07, 15.14, 15.01, 15.52], ["2019/4/29", 14.88, 13.84, 13.73, 14.98], ["2019/4/30", 13.84, 13.64, 13.53, 14.04], ["2019/5/6", 12.53, 12.28, 12.28, 12.97], ["2019/5/7", 12.39, 12.52, 12.1, 12.56], ["2019/5/8", 12.2, 12.53, 12.12, 12.79], ["2019/5/9", 12.33, 12.53, 12.32, 12.74], ["2019/5/10", 12.78, 13.35, 12.59, 13.44], ["2019/5/13", 13.07, 12.89, 12.78, 13.16], ["2019/5/14", 12.87, 12.87, 12.83, 13.11], ["2019/5/15", 13.03, 13.12, 12.93, 13.19], ["2019/5/16", 13.12, 12.96, 12.82, 13.12], ["2019/5/17", 12.98, 12.35, 12.18, 12.99], ["2019/5/20", 12.31, 12.6, 12.17, 12.76], ["2019/5/21", 12.55, 12.82, 12.5, 12.96], ["2019/5/22", 12.75, 12.62, 12.45, 12.9], ["2019/5/23", 12.56, 12.58, 12.35, 12.88], ["2019/5/24", 12.61, 12.53, 12.5, 12.7], ["2019/5/27", 12.62, 12.96, 12.53, 13.07], ["2019/5/28", 12.88, 13.05, 12.83, 13.09], ["2019/5/29", 12.93, 13.05, 12.88, 13.22], ["2019/5/30", 12.9, 12.81, 12.63, 12.96], ["2019/5/31", 12.8, 12.65, 12.65, 12.87], ["2019/6/3", 12.81, 12.64, 12.61, 12.95], ["2019/6/4", 12.6, 12.55, 12.45, 12.66], ["2019/6/5", 12.73, 12.59, 12.54, 12.8], ["2019/6/6", 12.54, 12.27, 12.23, 12.68], ["2019/6/10", 12.4, 12.37, 12.28, 12.54], ["2019/6/11", 12.33, 12.41, 12.28, 12.54]]);


		function splitData(rawData) {
			var categoryData = [];
			var values = []
			for (var i = 0; i < rawData.length; i++) {
				categoryData.push(rawData[i].splice(0, 1)[0]);
				values.push(rawData[i])
			}
			return {
				categoryData: categoryData,
				values: values
			};
		}

		function calculateMA(dayCount) {
			var result = [];
			for (var i = 0, len = data0.values.length; i < len; i++) {
				if (i < dayCount) {
					result.push('-');
					continue;
				}
				var sum = 0;
				for (var j = 0; j < dayCount; j++) {
					sum += data0.values[i - j][1];
				}
				result.push(sum / dayCount);
			}
			return result;
		}



		option = {
			title: {
				text: chartTitle,
				left: 0
			},
			tooltip: {
				trigger: 'axis',
				axisPointer: {
					type: 'cross'
				}
			},
			legend: {
				data: ['日K', 'MA5', 'MA10', 'MA20', 'MA30']
			},
			grid: {
				left: '10%',
				right: '10%',
				bottom: '15%'
			},
			xAxis: {
				type: 'category',
				data: data0.categoryData,
				scale: true,
				boundaryGap : false,
				axisLine: {onZero: false},
				splitLine: {show: false},
				splitNumber: 20,
				min: 'dataMin',
				max: 'dataMax'
			},
			yAxis: {
				scale: true,
				splitArea: {
					show: true
				}
			},
			dataZoom: [
				{
					type: 'inside',
					start: 50,
					end: 100
				},
				{
					show: true,
					type: 'slider',
					y: '90%',
					start: 50,
					end: 100
				}
			],
			series: [
				{
					name: '日K',
					type: 'candlestick',
					data: data0.values,
					itemStyle: {
						normal: {
							color: upColor,
							color0: downColor,
							borderColor: upBorderColor,
							borderColor0: downBorderColor
						}
					},
					markPoint: {
						label: {
							normal: {
								formatter: function (param) {
									return param != null ? Math.round(param.value) : '';
								}
							}
						},
						data: [
							{
								name: 'XX标点',
								coord: ['2013/5/31', 2300],
								value: 2300,
								itemStyle: {
									normal: {color: 'rgb(41,60,85)'}
								}
							},
							{
								name: 'highest value',
								type: 'max',
								valueDim: 'highest'
							},
							{
								name: 'lowest value',
								type: 'min',
								valueDim: 'lowest'
							},
							{
								name: 'average value on close',
								type: 'average',
								valueDim: 'close'
							}
						],
						tooltip: {
							formatter: function (param) {
								return param.name + '<br>' + (param.data.coord || '');
							}
						}
					},
					markLine: {
						symbol: ['none', 'none'],
						data: [
							[
								{
									name: 'from lowest to highest',
									type: 'min',
									valueDim: 'lowest',
									symbol: 'circle',
									symbolSize: 10,
									label: {
										normal: {show: false},
										emphasis: {show: false}
									}
								},
								{
									type: 'max',
									valueDim: 'highest',
									symbol: 'circle',
									symbolSize: 10,
									label: {
										normal: {show: false},
										emphasis: {show: false}
									}
								}
							],
							{
								name: 'min line on close',
								type: 'min',
								valueDim: 'close'
							},
							{
								name: 'max line on close',
								type: 'max',
								valueDim: 'close'
							}
						]
					}
				},
				{
					name: 'MA5',
					type: 'line',
					data: calculateMA(5),
					smooth: true,
					lineStyle: {
						normal: {opacity: 0.5}
					}
				},
				{
					name: 'MA10',
					type: 'line',
					data: calculateMA(10),
					smooth: true,
					lineStyle: {
						normal: {opacity: 0.5}
					}
				},
				{
					name: 'MA20',
					type: 'line',
					data: calculateMA(20),
					smooth: true,
					lineStyle: {
						normal: {opacity: 0.5}
					}
				},
				{
					name: 'MA30',
					type: 'line',
					data: calculateMA(30),
					smooth: true,
					lineStyle: {
						normal: {opacity: 0.5}
					}
				},

			]
		};

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
</body>
</html>